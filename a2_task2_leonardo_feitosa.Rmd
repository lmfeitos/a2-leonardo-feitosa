---
title: "a2_task2_leonardo_feitosa"
author: "Leonardo Feitosa"
date: "31/01/2021"
output: html_document
  code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
library(naniar)
library(kableExtra)
library(broom)
library(GGally)
```


## Read in the data

```{r}
palmetto <- read_csv(here("data", "palmetto.csv"), col_types = cols(.default = 'c')) %>% 
  mutate(height = as.numeric(height)) %>% 
  mutate(species = case_when(
    species %in% 1 ~ "Serenoa repens",
    species %in% 2 ~ "Sabal etonia"
  ))

# Palmetto subset
palmetto_sub <- palmetto %>% 
  select(species, height, length, width, green_lvs) %>% 
  mutate(length = as.numeric(length),
         width = as.numeric(width),
         green_lvs = as.numeric(green_lvs)) %>% 
  drop_na()

# Exploring NAs
gg_miss_upset(palmetto_sub)
```



## Data Viz

```{r}
# Exploratory plots

ggpairs(palmetto_sub, aes(color = species))

# First plot
ggplot(palmetto_sub, aes(x = species, y = height)) +
  geom_jitter(color = "goldenrod4",
              alpha = 0.3,
              width = 0.35) +
  geom_boxplot(aes(fill = species),
               show.legend = F,
               alpha = 0.9) +
  scale_fill_brewer(palette = "Set1") +
  labs(x = "Species",
       y = "Height") +
  theme_classic() +
  theme(axis.title = element_text(size = 12, color = "black", face = "bold"),
        axis.text = element_text(size = 10, color = "gray18"),
        axis.text.x = element_text(face = "italic"))

# Second plot
ggplot(palmetto_sub, aes(x = height, y = width)) +
  geom_point(aes(color = species),
             show.legend = F) +
  labs(x = "Height",
       y = "Width") +
  theme_bw() +
  theme(axis.title = element_text(size = 12, color = "black", face = "bold"),
        panel.grid = element_blank())

# Third plot
ggplot(palmetto_sub, aes(x = height, y = green_lvs)) +
  geom_point(aes(color = species),
             show.legend = F) +
  labs(x = "Height",
       y = "Length") +
  theme_bw() +
  theme(axis.title = element_text(size = 12, color = "black", face = "bold"),
        axis.text = element_text(size = 10, color = "gray18"),
        panel.grid = element_blank())
```





## Binary logistic regression

```{r}
# Binary logistic regression
palmetto_binary <- palmetto_sub %>% 
  mutate(species_binary = case_when(
    species %in% c("Serenoa repens") ~ 0,
    species %in% c("Sabal etonia") ~ 1
  ))

palmetto_blr <- glm(species_binary ~ length + height + width + green_lvs, data = palmetto_binary, family = "binomial")

palmetto_blr

# Model outputs
summary(palmetto_blr)

palmetto_blr_tidy <- broom::tidy(palmetto_blr)
```

```{r, results = "asis"}
# Finalized table
```














## Model fit








